{% extends 'dashboard/jobs/job_base.html' %}

{% load url from future %}

{% load currency_filters %}
{% load sorting_tags %}
{% load i18n %}


{% block breadcrumbs %}
    <ul class="breadcrumb">
        <li>
            <a href="{% url 'dashboard:index' %}">{% trans "Dashboard" %}</a>
            <span class="divider">/</span>
        </li>
        <li>
            <a href="{% url 'job-list' %}">{% trans "Jobs" %}</a>
            <span class="divider">/</span>
        </li>
        <li class="active">Task</li>
    </ul>
{% endblock %}

{% block dashboard_content %}
<div class="row-fluid">
    <div class="span3">
        <h3>Common Descriptions</h3>
        {% for desc in common_descriptions %}
        <p>
            <input type="radio" class="radio-select">&nbsp;&nbsp;&nbsp;<span class="desc">{{ desc }}</span>
            <a href="{% url 'delete-common-desc' form.initial.job.id desc.id %}" class="delete-desc" style="color:red; float:right;">x</a>
        </p>
        {% endfor %}
    </div>
    <div class="span6 well job">
    <form action="." method="post">{% csrf_token%}
        <legend>Task</legend>
    {{ form.as_p }}
    
    <button type="submit" class="btn btn-primary">Save</button>
    </form>
    </div>
</div>
{% endblock dashboard_content %}


{% block onbodyload %}
    {{ block.super }}
    $(function() {
        $(".datePicker").datepicker();
        $('.radio-select').click(function(){
            $('#id_description').val($(this).parent().find('.desc').html());
        });
        $('.delete-desc').click(function(e){
            e.preventDefault();
            var that = $(this);
            var url = that[0].href ;
            console.log(url);
            $.ajax({
                type: "POST",
                url: url,
                data: {
                    'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
                },
                success: function(){
                    that.parent().hide('slow');
                },
            });
        });
    });
{% endblock onbodyload %}