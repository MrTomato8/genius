{% extends 'layout.html' %}
{% load staticfiles %}

{% block extrastyles %}
{{ block.super }}
<link rel="stylesheet" type="text/css" href="{% static "options/css/styles.css" %}" />
{% endblock %}

{% block breadcrumbs %}
<div class="set-size-grid clearfix">
  <div class="wizard-progress">
    <ul>
      <li><strong>Select Options</strong></li>
      <li>Get Quote</li>
      <li>Upload Files</li>
    </ul>
  </div>
  <h2>Select {{ product }}  Options</h2>
</div>
{% endblock %}
{% block content %}

<div id="title-target" class="center-block clearfix"></div>

<div class="clearfix stepy-centering">

<div id="form-errors" class="grid-8 float-left option-choice-errors">
{% if errors %}
<ul>
{% for error in errors %}
<li><strong>{{ error }}</strong></li>
{% endfor %}
</ul>
{% endif %}
</div>

<form id="pickoptions" method="POST">{% csrf_token %}

    {% for group in groups %}

    <fieldset title="{{ group.group.name }}">
      <br />
      <div class="grid-8 float-left">
        <ul class="options-group">
            {% for picker in group.pickers %}
            <li>
                <h3 class="option-title">&nbsp;&nbsp;{{ picker.picker.option }}</h3>

                <div id="choice-{{ picker.picker.option.code }}-errors" class="option-choice-errors">
                  {% if picker.form.choice_errors %}
                  <ul>
                    {% for error in picker.form.choice_errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                  </ul>
                  {% endif %}
                </div>

                {% for field in picker.form.visible_fields %}
                {% if picker.picker.widget == picker.picker.THUMBNAIL %}
                <div class="option-choice" style="width:350px;">
                  <ul id="carousel-{{ picker.picker.id }}" class="jcarousel-skin-tango">
                    {% for choice in field.field.queryset %}
                    <li>
                        {{ choice.caption }}<br />
                        <img src="{% static choice.get_thumbnail.name %}" alt="{{ choice.caption }}"/><br />
                        <input type="radio" name="{{ field.name }}" value="{{ choice.pk }}"
                          {% ifequal field.data|slugify choice.pk|slugify %}
                             checked="checked"
                          {% endifequal %} />
                    </li>
                    {% endfor %}
                  </ul>
                </div>
                <script type="text/javascript">
                  $('#carousel-{{ picker.picker.id }}').jcarousel();
                </script>
                {% endif %}

                {% if picker.picker.widget == picker.picker.DROPDOWN %}
                <div class="option-choice">
                  {{ field }}
                </div>
                {% endif %}

                {% endfor %}
            </li>
            {% endfor %}
        </ul>
      </div>
    </fieldset>
    {% endfor %}
    <input value="Get Quote" type="submit" class="finish button"/>
</form>
</div>
<script type="text/javascript">
$(document).ready(function(){
  $('#pickoptions').stepy({
    legend:false,
    titleTarget: '#title-target',
    description: false,
    validate: false
  });

  $('.options-group .option-choice').hide();
  $('.options-group > li:first-child').find('.option-choice').show();
  $('.options-group .option-title').addClass('icon-arrow-up');
  $('.options-group > li:first-child').find('.option-title').removeClass('icon-arrow-up').addClass('icon-arrow-down');

  $('.option-title').click(function(){
    $(this).parent().parent().find('.option-choice').hide('slow');
    $(this).parent().find('.option-choice').show('slow');

    $(this).parent().parent().find('.option-title').removeClass('icon-arrow-down').addClass('icon-arrow-up');
    $(this).parent().find('.option-title').removeClass('icon-arrow-up').addClass('icon-arrow-down');
  });
});
</script>
{% endblock %}